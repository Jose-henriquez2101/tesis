<div class="restablecer-container">
  <div class="restablecer-card">
    <div class="logo-container">
      <h1>ğŸ”¥ Sistema VR Bomberos</h1>
    </div>

    <h2>Restablecer ContraseÃ±a</h2>
    <p class="instrucciones" *ngIf="tokenValido">
      Ingresa tu nueva contraseÃ±a a continuaciÃ³n.
    </p>

    <!-- Mensajes de Ã©xito o error -->
    <div *ngIf="mensaje" class="mensaje" [ngClass]="mensajeTipo">
      <span>{{ mensaje }}</span>
    </div>

    <form (ngSubmit)="onSubmit()" #restablecerForm="ngForm" *ngIf="tokenValido">
      <!-- Nueva ContraseÃ±a -->
      <div class="form-group">
        <label for="nuevaContrasena">Nueva ContraseÃ±a</label>
        <div class="password-input-wrapper">
          <input
            [type]="mostrarContrasena ? 'text' : 'password'"
            id="nuevaContrasena"
            name="nuevaContrasena"
            [(ngModel)]="nuevaContrasena"
            placeholder="Ingresa tu nueva contraseÃ±a"
            required
            minlength="6"
            [disabled]="procesando"
          />
          <button 
            type="button" 
            class="toggle-password" 
            (click)="toggleMostrarContrasena()"
            [disabled]="procesando"
          >
            <span *ngIf="!mostrarContrasena">ğŸ‘ï¸</span>
            <span *ngIf="mostrarContrasena">ğŸ™ˆ</span>
          </button>
        </div>
        <div class="password-strength" *ngIf="nuevaContrasena.length > 0">
          <div class="strength-bar" [ngClass]="getStrengthClass()"></div>
          <span class="strength-text">{{ getStrengthText() }}</span>
        </div>
      </div>

      <!-- Confirmar ContraseÃ±a -->
      <div class="form-group">
        <label for="confirmarContrasena">Confirmar ContraseÃ±a</label>
        <div class="password-input-wrapper">
          <input
            [type]="mostrarConfirmacion ? 'text' : 'password'"
            id="confirmarContrasena"
            name="confirmarContrasena"
            [(ngModel)]="confirmarContrasena"
            placeholder="Confirma tu nueva contraseÃ±a"
            required
            [disabled]="procesando"
          />
          <button 
            type="button" 
            class="toggle-password" 
            (click)="toggleMostrarConfirmacion()"
            [disabled]="procesando"
          >
            <span *ngIf="!mostrarConfirmacion">ğŸ‘ï¸</span>
            <span *ngIf="mostrarConfirmacion">ğŸ™ˆ</span>
          </button>
        </div>
        <div class="password-match" *ngIf="confirmarContrasena.length > 0">
          <span *ngIf="nuevaContrasena === confirmarContrasena" class="match">
            âœ“ Las contraseÃ±as coinciden
          </span>
          <span *ngIf="nuevaContrasena !== confirmarContrasena" class="no-match">
            âœ— Las contraseÃ±as no coinciden
          </span>
        </div>
      </div>

      <button 
        type="submit" 
        class="btn-primary" 
        [disabled]="procesando || !restablecerForm.valid || nuevaContrasena !== confirmarContrasena"
      >
        <span *ngIf="!procesando">Restablecer ContraseÃ±a</span>
        <span *ngIf="procesando">Procesando...</span>
      </button>
    </form>

    <div class="footer-links">
      <a routerLink="/login" class="link">Volver al Inicio de SesiÃ³n</a>
    </div>
  </div>
</div>
